package com.vulnerabilityfixer.fixer;

import org.springframework.stereotype.Component;
import org.xml.sax.SAXException;

import javax.xml.parsers.ParserConfigurationException;
import java.io.File;
import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;

@Component
public class VulnerabilityLocation
{
    public void fixProject()
    {
        Path repositoryPath;
        repositoryPath = getRepository();
        String projectPath = unZip(repositoryPath);
        fix(projectPath);
    }

    private void fix(String project)
    {
        //get xml files.
        String sqliReport = "sqlibug.xml";
        String xssReport = "xssbug.xml";

        try {
            XmlParser.parseXml(sqliReport);
            XmlParser.parseXml(xssReport);
        } catch (ParserConfigurationException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (SAXException e) {
            e.printStackTrace();
        }
    }



    private String unZip(Path repositoryPath)
    {
        return "RETURN DIRECTORY NAME WHERE FILES ARE UNZIPPED";
    }

    private Path getRepository() //get repository from S3.
    {
        File file = new File("./xs.zip");
        Path path = Paths.get("./" + file.getName());

        return path;
    }

}
